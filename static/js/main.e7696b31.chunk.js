(this.webpackJsonpbookmaps=this.webpackJsonpbookmaps||[]).push([[0],{114:function(e,t,a){},97:function(e,t,a){e.exports=a(98)},98:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return P}));var n=a(19),r=a.n(n),c=a(22),i=a(23),l=a(13),o=a(27),s=a(26),u=a(24),p=a(0),m=a(18),h=a.n(m),d=a(6),k=a(35),v=a.n(k),y=a(36),C=a.n(y),b=(a(114),a(12)),f=a.n(b),g=void 0,E=[];!function(e){g=JSON.parse(e);for(var t=1;t!==g.chapters;t++)E.push({key:t,value:[g.data[t].name,t,g.data[t].marks,g.data[t].data]})}('{"book_name": "\u041c\u0430\u0441\u0442\u0435\u0440 \u0438 \u041c\u0430\u0440\u0433\u0430\u0440\u0438\u0442\u0430","chapters": 2,"data": {"1" : {"name": "\u041f\u0435\u0440\u0432\u0430\u044f \u0433\u043b\u0430\u0432\u0430","marks": [["0", "\u041d\u0430\u0447\u0430\u043b\u043e"],["1", "\u0421\u0435\u0440\u0435\u0434\u0438\u043d\u0430"],["2", "\u041a\u043e\u043d\u0435\u0446"]], "data": [["mark", "0"],["\u041a\u043e\u0442", [55.7522, 37.6156], 2],["\u041a\u043e\u0442", [55.7622, 37.7156], 4],\t["mark", "1"],["del", "\u041a\u043e\u0442"],["mark", "2"],["\u041c\u0430\u0441\u0442\u0435\u0440", [55.8522, 37.5956], 3]]},"2" : {"name": "\u0412\u0442\u043e\u0440\u0430\u044f \u0433\u043b\u0430\u0432\u0430","marks": [["0", "\u041d\u0430\u0447\u0430\u043b\u043e"],["center", "\u0421\u0435\u0440\u0435\u0434\u0438\u043d\u0430"],["1", "\u0421\u0435\u0440\u0435\u0434\u0438\u043d\u0430"],["end", "\u041a\u043e\u043d\u0435\u0446"]],"data": [["mark", "0"],["\u0410\u0437\u0430\u0437\u0435\u043b\u043b\u043e", [55.7522, 37.6156], 2],["\u0411\u0435\u0433\u0435\u043c\u043e\u0442", [55.7522, 37.6156], 4],\t["mark", "1"],["del", "\u0411\u0435\u0433\u0435\u043c\u043e\u0442"],["\u0410\u0437\u0430\u0437\u0435\u043b\u043b\u043e", [55.8522, 37.5956], 3],["mark", "2"],["del", "\u0410\u0437\u0430\u0437\u0435\u043b\u043b\u043e"]]}} }');var x=[],j=document.documentElement.clientWidth,S=document.documentElement.clientHeight;function O(e){return M.apply(this,arguments)}function M(){return(M=Object(u.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I={height:S,width:j};I.height=j<S?j:I.height-102;var L=f.a.latLng(55.7522,37.6156),w=14,P=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).pause=!1,n.persons={},n.play=n.play.bind(Object(l.a)(n)),n}return Object(i.a)(a,[{key:"play",value:function(){var e=Object(u.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(x.length>0)){e.next=15;break}if("del"!==(t=x[0])[0]){e.next=6;break}t[1]in this.persons?(this.persons[t[1]].remove(),this.persons[t[1]]=void 0):alert("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441 \u043a\u0430\u0440\u0442\u044b \u043d\u0435\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430."),e.next=10;break;case 6:return t[0]in this.persons&&this.persons[t[0]].remove(),this.persons[t[0]]=f.a.popup().setLatLng(f.a.latLng(t[1][0],t[1][1])).setContent("<br>"+t[0]+"<br/>").openOn(this.mymap),e.next=10,O(1e3*t[2]).then();case 10:if(x.shift(),!this.pause){e.next=13;break}return e.abrupt("break",15);case 13:e.next=0;break;case 15:case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return p.createElement("div",{id:"mapid",style:I})}},{key:"componentDidMount",value:function(){this.mymap=f.a.map("mapid").setView(L,w).setMaxBounds(f.a.latLngBounds(f.a.latLng(56,37),f.a.latLng(55.5,38.25))),f.a.tileLayer("https://api.mapbox.com/styles/v1/black-horse/ck9423ydx3ezj1ip93plhxxbb/tiles/{z}/{x}/{y}?access_token={accessToken}",{minZoom:10,maxZoom:17,updateWhenZooming:!1,updateWhenIdle:!0,bounds:f.a.latLngBounds(f.a.latLng(56.25,35),f.a.latLng(55.25,39)),accessToken:"pk.eyJ1IjoiYmxhY2staG9yc2UiLCJhIjoiY2thMndiMDg5MDdjMDNsbGt1eHdoYjR6diJ9.z1NmmuGOTudn-b5H5NDtWg"}).addTo(this.mymap),this.play()}},{key:"componentWillUnmount",value:function(){L=this.mymap.getCenter(),w=this.mymap.getZoom(),this.mymap=null}}]),a}(p.Component),T=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={activeStory:"map",activeScreen:"intro",activePanelChapter:"chapter_select",activeChapter:1,MarksInChapter:[]},n.onStoryChange=n.onStoryChange.bind(Object(l.a)(n)),n.onIntroClick=n.onIntroClick.bind(Object(l.a)(n)),n.onChapterCellClick=n.onChapterCellClick.bind(Object(l.a)(n)),n.onMarkCellClick=n.onMarkCellClick.bind(Object(l.a)(n)),n}return Object(i.a)(a,[{key:"onStoryChange",value:function(e){this.setState({activeStory:e.currentTarget.dataset.story})}},{key:"onIntroClick",value:function(e){this.setState({activeScreen:"things"})}},{key:"onChapterCellClick",value:function(e,t){var a=[],n=0;E[t-1].value[2].forEach((function(e){a.push({key:n,value:e}),++n})),this.setState({activeChapter:t,MarksInChapter:a}),this.setState({activePanelChapter:"mark_select"})}},{key:"onMarkCellClick",value:function(e,t){var a=this.state.MarksInChapter[t].value[0],n=!1;E[this.state.activeChapter-1].value[3].forEach((function(e){n&&"mark"!==e[0]&&x.push(e),"mark"===e[0]&&e[1]===a&&(n=!0)})),this.setState({activePanelChapter:"chapter_select",activeStory:"map"})}},{key:"render",value:function(){return p.createElement(d.h,{activeView:this.state.activeScreen},p.createElement(d.k,{id:"intro"},p.createElement(d.c,{style:{paddingTop:60,paddingBottom:60,color:"gray"}},p.createElement("p",{style:{textAlign:"center",verticalAlign:"middle"}},"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"),p.createElement("p",null,"\u042d\u0442\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0433\u0440\u0443\u043f\u043f\u043e\u0439 \u044e\u043d\u044b\u0445 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u043e\u0432 \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043d\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432 \u0410\u043a\u0430\u0434\u0435\u043c\u0438\u0438 \u041a\u0430\u043b\u0430\u0448\u043d\u0438\u043a\u043e\u0432. \u041e\u043d\u043e \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u043b\u044e\u0434\u044f\u043c, \u043b\u044e\u0431\u044f\u0449\u0438\u043c \u043a\u043d\u0438\u0433\u0438 \u0438 \u043f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f, \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u043e\u0431\u043e\u043b\u044c\u0448\u0435 \u043e \u0442\u0435\u0445 \u043c\u0435\u0441\u0442\u0430\u0445, \u0433\u0434\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u043b\u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u0437 \u043a\u043d\u0438\u0433\u0438, \u0438 \u0434\u0430\u0436\u0435 \u043f\u0440\u043e\u0439\u0442\u0438 \u043f\u043e \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430\u043c \u0435\u0451 \u0433\u0435\u0440\u043e\u0435\u0432. \u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043f\u043e\u043d\u044f\u0442\u043d\u043e \u0438 \u043b\u0435\u0433\u043a\u043e \u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438."),p.createElement("p",null,"\u041f\u0440\u043e\u0434\u0443\u043a\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0438 \u0441\u043e\u0432\u0441\u0435\u043c \u0441\u043a\u043e\u0440\u043e \u0441\u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0440\u0430\u0434\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u043c\u0438 \u043d\u043e\u0432\u0438\u043d\u043a\u0430\u043c\u0438! \u0422\u0430\u043a \u0447\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0438\u043b\u0438 \u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u0432\u043e\u0438 \u043f\u043e\u0436\u0435\u043b\u0430\u043d\u0438\u044f!"),p.createElement(d.a,{size:"xl",mode:"secondary",onClick:this.onIntroClick},"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"))),p.createElement(d.d,{id:"things",activeStory:this.state.activeStory,tabbar:p.createElement(d.i,null,p.createElement(d.j,{onClick:this.onStoryChange,selected:"map"===this.state.activeStory,"data-story":"map",text:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"},p.createElement(v.a,null)),p.createElement(d.j,{onClick:this.onStoryChange,selected:"chapter"===this.state.activeStory,"data-story":"chapter",text:"\u0413\u043b\u0430\u0432\u044b"},p.createElement(C.a,null)))},p.createElement(d.k,{id:"map",activePanel:"map"},p.createElement(d.f,{id:"map"},p.createElement(d.g,null,"\u041a\u0430\u0440\u0442\u0430"),p.createElement(P,null))),p.createElement(d.k,{id:"chapter",activePanel:this.state.activePanelChapter},p.createElement(d.f,{id:"chapter_select"},p.createElement(d.g,null,"\u0412\u044b\u0431\u043e\u0440 \u0433\u043b\u0430\u0432\u044b"),p.createElement(d.e,null,Array.prototype.map.call(E,(function(e){var t=this;return p.createElement(d.b,{expandable:!0,onClick:function(a){return t.onChapterCellClick(a,e.value[1])}},"\u0413\u043b\u0430\u0432\u0430 ",e.value[1],": ",e.value[0])}),this))),p.createElement(d.f,{id:"mark_select"},p.createElement(d.g,null,"\u0412\u044b\u0431\u043e\u0440 \u0437\u0430\u043a\u043b\u0430\u0434\u043a\u0438"),p.createElement(d.e,null,Array.prototype.map.call(this.state.MarksInChapter,(function(e){var t=this;return p.createElement(d.b,{expandble:!0,onClick:function(a){return t.onMarkCellClick(a,e.value[0])}},e.value[1])}),this))))))}}]),a}(p.Component);h.a.render(p.createElement(T,null),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.e7696b31.chunk.js.map